---
phase: 06.9-camera-matching
plan: 03
type: execute
wave: 3
depends_on: [06.9-02]
files_modified:
  - lib/cinematic/__init__.py
  - configs/cinematic/tracking/camera_profiles.yaml
autonomous: true

must_haves:
  truths:
    - "All camera matching exports available"
    - "Version bumped to 0.2.5"
    - "Camera profile presets available"
  artifacts:
    - path: "lib/cinematic/__init__.py"
      provides: "Camera matching and audio sync exports"
      exports: ["CameraMatchConfig", "TrackingImportConfig", "AudioSyncConfig", "CameraProfile", "match_camera_to_reference", "import_tracking_data", "load_audio", "place_beat_markers"]
    - path: "configs/cinematic/tracking/camera_profiles.yaml"
      provides: "Device camera profiles"
---

<objective>
Update __init__.py with camera matching exports and create camera profiles YAML.

Purpose: Complete camera matching system with exports and device profiles.
Output: Updated __init__.py (v0.2.5), camera_profiles.yaml with device profiles.
</objective>

<execution_context>
@/Users/bretbouchard/.claude/get-shit-done/workflows/execute-plan.md
@/Users/bretbouchard/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Existing patterns
@lib/cinematic/__init__.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create camera profiles YAML</name>
  <files>configs/cinematic/tracking/camera_profiles.yaml</files>
  <action>
Create `configs/cinematic/tracking/camera_profiles.yaml` with device camera profiles.

```yaml
# Camera Device Profiles (REQ-CINE-MATCH)
# Device-specific camera parameters for accurate matching

profiles:
  # === SMARTPHONE CAMERAS ===

  iphone_15_pro_main:
    name: "iPhone 15 Pro Main Camera"
    sensor_width: 9.8
    sensor_height: 7.3
    focal_length: 6.77  # 24mm equivalent
    distortion_model: simple
    distortion_params: [0.02, -0.01]
    crop_factor: 2.94
    aspect_ratio: 1.0

  iphone_15_pro_telephoto:
    name: "iPhone 15 Pro Telephoto"
    sensor_width: 5.6
    sensor_height: 4.2
    focal_length: 9.0  # 77mm equivalent
    distortion_model: simple
    distortion_params: [0.01, 0.0]
    crop_factor: 4.3
    aspect_ratio: 1.0

  iphone_14_pro_main:
    name: "iPhone 14 Pro Main Camera"
    sensor_width: 9.8
    sensor_height: 7.3
    focal_length: 6.86
    distortion_model: simple
    distortion_params: [0.02, -0.01]
    crop_factor: 2.96
    aspect_ratio: 1.0

  pixel_8_pro_main:
    name: "Google Pixel 8 Pro Main"
    sensor_width: 10.2
    sensor_height: 7.6
    focal_length: 6.81
    distortion_model: simple
    distortion_params: [0.015, -0.005]
    crop_factor: 2.97
    aspect_ratio: 1.0

  # === CINEMA CAMERAS ===

  red_komodo_6k:
    name: "RED KOMODO 6K"
    sensor_width: 27.03
    sensor_height: 14.26
    focal_length: 50.0  # Default with 50mm lens
    distortion_model: none
    distortion_params: []
    crop_factor: 1.33
    aspect_ratio: 1.9

  arri_alexa_mini:
    name: "ARRI ALEXA Mini"
    sensor_width: 28.25
    sensor_height: 15.78
    focal_length: 50.0
    distortion_model: none
    distortion_params: []
    crop_factor: 1.27
    aspect_ratio: 1.79

  blackmagic_pocket_6k:
    name: "Blackmagic Pocket 6K"
    sensor_width: 23.10
    sensor_height: 12.99
    focal_length: 50.0
    distortion_model: simple
    distortion_params: [0.005, 0.0]
    crop_factor: 1.56
    aspect_ratio: 1.78

  # === DSLR/MIRRORLESS ===

  sony_a7iv:
    name: "Sony A7 IV"
    sensor_width: 35.9
    sensor_height: 23.9
    focal_length: 50.0
    distortion_model: none
    distortion_params: []
    crop_factor: 1.0
    aspect_ratio: 1.5

  canon_r5:
    name: "Canon EOS R5"
    sensor_width: 36.0
    sensor_height: 24.0
    focal_length: 50.0
    distortion_model: none
    distortion_params: []
    crop_factor: 1.0
    aspect_ratio: 1.5

  fuji_xt5:
    name: "Fujifilm X-T5"
    sensor_width: 23.5
    sensor_height: 15.6
    focal_length: 50.0
    distortion_model: none
    distortion_params: []
    crop_factor: 1.53
    aspect_ratio: 1.5

  # === ACTION CAMERAS ===

  gopro_hero12:
    name: "GoPro Hero 12"
    sensor_width: 6.3
    sensor_height: 4.7
    focal_length: 2.9  # Wide
    distortion_model: brown_conrady
    distortion_params: [-0.25, 0.08, 0.0, 0.0, 0.0]
    crop_factor: 5.7
    aspect_ratio: 1.33

  dji_osmo_action:
    name: "DJI Osmo Action"
    sensor_width: 6.3
    sensor_height: 4.7
    focal_length: 2.8
    distortion_model: brown_conrady
    distortion_params: [-0.22, 0.06, 0.0, 0.0, 0.0]
    crop_factor: 5.7
    aspect_ratio: 1.33

  # === DRONE CAMERAS ===

  dji_mavic_3_pro:
    name: "DJI Mavic 3 Pro Main"
    sensor_width: 17.3
    sensor_height: 13.0
    focal_length: 12.3  # 24mm equivalent
    distortion_model: simple
    distortion_params: [0.01, 0.0]
    crop_factor: 2.08
    aspect_ratio: 1.33

  dji_mini_4_pro:
    name: "DJI Mini 4 Pro"
    sensor_width: 9.6
    sensor_height: 7.2
    focal_length: 6.3
    distortion_model: simple
    distortion_params: [0.02, -0.01]
    crop_factor: 3.75
    aspect_ratio: 1.33
```
  </action>
  <verify>python3 -c "
import yaml
from pathlib import Path
path = Path('configs/cinematic/tracking/camera_profiles.yaml')
if path.exists():
    with open(path) as f:
        data = yaml.safe_load(f)
    profiles = data.get('profiles', {})
    assert 'iphone_15_pro_main' in profiles, 'iphone_15_pro_main missing'
    assert 'sony_a7iv' in profiles, 'sony_a7iv missing'
    assert 'red_komodo_6k' in profiles, 'red_komodo_6k missing'
    print(f'camera_profiles.yaml OK - {len(profiles)} profiles')
else:
    print('camera_profiles.yaml created')
"</verify>
  <done>camera_profiles.yaml with device profiles</done>
</task>

<task type="auto">
  <name>Task 2: Update __init__.py with camera matching exports</name>
  <files>lib/cinematic/__init__.py</files>
  <action>
Update `lib/cinematic/__init__.py` to:

1. Update version to 0.2.5
2. Add imports for camera matching types and functions
3. Add exports for camera_match and audio_sync modules

Add after existing imports:
```python
# Camera Matching & Audio Sync (Phase 6.9)
from .types import CameraMatchConfig, TrackingImportConfig, AudioSyncConfig, CameraProfile
from .camera_match import (
    match_camera_to_reference,
    import_tracking_data,
    estimate_focal_length,
    detect_horizon_line,
    apply_camera_profile,
)
from .audio_sync import (
    load_audio,
    place_beat_markers,
    detect_bpm,
    create_animation_markers,
    get_frame_at_beat,
    get_beat_at_frame,
)
```

Add to __all__ list:
```python
    # Camera Matching & Audio Sync
    "CameraMatchConfig",
    "TrackingImportConfig",
    "AudioSyncConfig",
    "CameraProfile",
    "match_camera_to_reference",
    "import_tracking_data",
    "estimate_focal_length",
    "detect_horizon_line",
    "apply_camera_profile",
    "load_audio",
    "place_beat_markers",
    "detect_bpm",
    "create_animation_markers",
    "get_frame_at_beat",
    "get_beat_at_frame",
```

Update version:
```python
__version__ = "0.2.5"
```
  </action>
  <verify>python3 -c "
from lib.cinematic import (
    CameraMatchConfig, TrackingImportConfig, AudioSyncConfig, CameraProfile,
    match_camera_to_reference, import_tracking_data, estimate_focal_length,
    load_audio, place_beat_markers, create_animation_markers, __version__
)
assert __version__ == '0.2.5', f'Version mismatch: {__version__}'
print(f'Version {__version__} - Camera matching exports OK')
"</verify>
  <done>__init__.py updated with camera matching exports, version 0.2.5</done>
</task>

</tasks>

<verification>
1. camera_profiles.yaml exists with multiple device types
2. __init__.py exports all camera matching types/functions
3. Version is 0.2.5
4. All imports work
</verification>

<success_criteria>
- Camera profile presets available in camera_profiles.yaml
- Smartphone, cinema, DSLR, action, and drone cameras covered
- All exports available from cinematic package
- Version bumped to 0.2.5
</success_criteria>

<output>
After completion, create `.planning/phases/06.9-camera-matching/06.9-03-SUMMARY.md`
</output>
