# Phase 8.2: Shot List Generator Summary

**Phase**: 8.2
**Plan**: 8.2-01
**Status**: Complete
**Date**: 2026-02-20
**Version**: 0.6.0

---

## Overview

Implemented automatic shot list generation from parsed scripts with intelligent coverage suggestions, shot size recommendations, and storyboard prompt generation.

---

## Requirements Satisfied

| Requirement | Description | Status |
|-------------|-------------|--------|
| REQ-SHOT-01 | Auto-generate shots from scenes | Complete |
| REQ-SHOT-02 | Coverage estimation | Complete |
| REQ-SHOT-03 | Shot size suggestions | Complete |
| REQ-SHOT-04 | Storyboard prompt generation | Complete |

---

## Files Created

```
lib/development/
├── shot_gen_types.py       (334 lines) - Core data types
├── scene_analyzer.py       (390 lines) - Scene analysis engine
├── shot_rules.py           (396 lines) - Coverage rules engine
├── storyboard_prompts.py   (338 lines) - AI prompt generation
├── shot_list_export.py     (430 lines) - Export functionality
└── test_shot_list_generator.py (542 lines) - 39 unit tests
```

---

## Module Details

### 1. shot_gen_types.py

Core data structures for shot list generation:

- `ShotSuggestion` - Single shot configuration with size, angle, subject, purpose
- `CoverageEstimate` - Scene coverage analysis with minimum/recommended counts
- `SceneShotList` - Shot list for a single scene
- `ShotList` - Complete production shot list with statistics
- `StoryboardPrompt` - AI image generation prompts

**Constants:**
- `SHOT_SIZES` - ECU, CU, MCU, MS, MFS, FS, WS, EWS
- `CAMERA_ANGLES` - Eye level, high, low, dutch, bird's eye, worm's eye
- `SHOT_PURPOSES` - Coverage, reaction, insert, establishing, transition
- `CAMERA_MOVES` - Static, pan, tilt, dolly, crane, handheld

### 2. scene_analyzer.py

Scene analysis for intelligent shot generation:

- `analyze_scene_for_shots()` - Main entry point for shot generation
- `analyze_scene_content()` - Comprehensive scene analysis
- `count_characters_in_scene()` - Speaking character counting
- `identify_scene_type()` - Dialogue, action, mixed, transition detection
- `estimate_scene_duration()` - Duration calculation
- `identify_key_moments()` - Key beat detection with keyword analysis
- `calculate_coverage_estimate()` - Coverage requirements

**Scene Types Detected:**
- `dialogue` - >70% dialogue content
- `action` - <30% dialogue content
- `mixed` - Balance of action and dialogue

### 3. shot_rules.py

Coverage rules engine:

- `apply_coverage_rules()` - Rule-based shot generation
- `suggest_shot_size()` - Context-aware shot size suggestions
- `suggest_camera_angle()` - Power dynamics and context angles
- `calculate_shot_priority()` - Essential/recommended/optional
- `get_coverage_summary()` - Scene coverage statistics

**Coverage Rules:**
- `dialogue_two_person` - Master, CUs, OTS, reactions
- `dialogue_multi_person` - Master, individual CUs, group shots
- `action` - Master, key beats, coverage angles
- `transition` - Establishing shots
- `montage` - Establishing, key beats, variations

### 4. storyboard_prompts.py

AI image generation support:

- `generate_storyboard_prompt()` - Full storyboard prompt
- `generate_ai_image_prompt()` - Style-aware AI prompt
- `create_shot_description()` - Human-readable descriptions
- `generate_batch_prompts()` - Multiple shot prompts
- `export_prompts_as_text()` - Text export

**Style Presets:**
- `cinematic` - Feature film look, shallow DOF
- `storyboard` - Rough sketch style
- `realistic` - Photorealistic
- `noir` - High contrast B&W
- `anime` - Animation style
- `concept_art` - Digital painting
- `comic` - Sequential art

### 5. shot_list_export.py

Multi-format export support:

- `export_shot_list_csv()` - CSV file export
- `export_shot_list_yaml()` - YAML file export
- `export_shot_list_json()` - JSON file export
- `export_shot_list_pdf()` - PDF export (with reportlab)
- `export_shot_list_html()` - Styled HTML export
- `generate_shot_report()` - Detailed text report
- `generate_producer_summary()` - Executive summary

---

## Test Results

```
39 tests passed in 0.22s

TestShotGenTypes (9 tests)
  - Dataclass creation and serialization
  - Shot labeling (1A, 5C, etc.)
  - Statistics calculation

TestSceneAnalyzer (9 tests)
  - Scene type detection
  - Character counting
  - Duration estimation
  - Key moment identification

TestShotRules (9 tests)
  - Coverage rules application
  - Shot size suggestions
  - Camera angle suggestions
  - Priority calculation

TestStoryboardPrompts (6 tests)
  - Prompt generation
  - Style presets
  - Batch generation

TestShotListExport (5 tests)
  - CSV, YAML, HTML export
  - Report generation

TestIntegration (1 test)
  - Full workflow from scene to exports
```

---

## Usage Example

```python
from lib.development import (
    Scene, ActionBlock, DialogueLine,
    analyze_scene_for_shots,
    ShotList, SceneShotList,
    generate_shot_report,
    export_shot_list_csv
)

# Create a scene
scene = Scene(
    number=1,
    heading="INT. COFFEE SHOP - DAY",
    location="COFFEE SHOP",
    interior=True,
    time_of_day="DAY",
    action=[ActionBlock("A busy morning.")],
    dialogue=[
        DialogueLine("Barista", "What can I get you?"),
        DialogueLine("Customer", "Large coffee, please.")
    ]
)

# Generate shots
shots = analyze_scene_for_shots(scene)

# Create shot list
shot_list = ShotList(production="Coffee Shop")
scene_list = SceneShotList(
    scene_number=1,
    scene_heading=scene.heading,
    shots=shots,
    estimated_duration=scene.estimate_duration()
)
shot_list.add_scene(scene_list)

# Export
report = generate_shot_report(shot_list)
export_shot_list_csv(shot_list, "shots.csv")
```

---

## Integration Points

- **Phase 8.1 Script Parser** - Uses `Scene`, `DialogueLine`, `ActionBlock` types
- **Phase 11.1 Timeline System** - Shot list can be converted to timeline clips
- **Phase 12.0 1-Sheet Generator** - Shot list data can populate 1-sheets

---

## Decisions Made

| Decision | Rationale |
|----------|-----------|
| Dialogue threshold at 70% | Standard screenplay analysis convention |
| 8 shot size types | Industry standard coverage options |
| 6 camera angles | Common cinematographic vocabulary |
| Priority: essential/recommended/optional | Flexible scheduling for productions |
| Style presets for AI prompts | Easy switching between visualization styles |

---

## Dependencies

- **Internal**: script_types (Phase 8.1)
- **Optional**: PyYAML, reportlab (graceful fallback)

---

## Next Steps

Phase 8.3 could include:
- Storyboard image generation API integration
- Shot list editing UI
- Import from scheduling software
- Integration with production tracking dashboard
