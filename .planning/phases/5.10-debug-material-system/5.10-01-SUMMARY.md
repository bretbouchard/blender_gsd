---
phase: 5.10-debug-material-system
plan: 01
status: complete
completed: 2026-02-19
files_modified:
  - lib/inputs/debug_materials.py (created)
  - lib/inputs/node_group_builder.py (modified)
  - lib/inputs/__init__.py (modified)
  - projects/inputs/render_knob.py (modified)
---

# Phase 5.10 - Debug Material System - Summary

## Completed Tasks

### Task 1: Debug Material Utilities
Created `lib/inputs/debug_materials.py` with:
- `DEBUG_COLORS` - Default rainbow palette (Red/Green/Blue/Yellow)
- `DEBUG_PRESETS` - Four preset palettes:
  - `rainbow`: Red/Green/Blue/Yellow
  - `grayscale`: 20%/40%/60%/80% gray
  - `complementary`: Cyan/Magenta/Yellow/Black
  - `heat_map`: Blue→Cyan→Yellow→Red
- `create_debug_material(name, color)` - Create a Principled BSDF material
- `create_debug_palette(preset_name)` - Get colors for a preset
- `create_all_debug_materials(preset)` - Create materials for all sections
- `get_debug_color(section, preset)` - Get color for specific section
- `SECTION_NAMES` - List of section names for iteration

### Task 2: Node Group Builder Integration
Modified `lib/inputs/node_group_builder.py`:
- Added `_material()` helper for creating material input sockets
- Added debug inputs to `_create_interface()`:
  - `Debug_Mode` (boolean, default=False)
  - `Debug_A_Top_Material` (material)
  - `Debug_A_Mid_Material` (material)
  - `Debug_B_Mid_Material` (material)
  - `Debug_B_Bot_Material` (material)
- Added `_create_material_switch()` helper - creates Switch node for material selection
- Added `_set_section_material()` helper - applies material with debug mode switching
- Modified OUTPUT frame to apply materials per-section BEFORE join:
  - Each section (A_Top, A_Mid, B_Mid, B_Bot) gets its own Set Material node
  - Switch nodes select between debug and production materials
  - No final Set Material after Join (materials applied per-section)

### Task 3: Package Exports
Updated `lib/inputs/__init__.py`:
- Added imports for all debug material functions
- Added to `__all__`: DEBUG_COLORS, DEBUG_PRESETS, SECTION_NAMES, create_debug_material, create_debug_palette, create_all_debug_materials, get_debug_color

### Task 4: Render Script Update
Updated `projects/inputs/render_knob.py`:
- Added `debug_mode` and `debug_preset` parameters to `create_knob_with_settings()`
- Added automatic debug material creation and assignment when debug_mode=True
- Added `render_debug()` convenience function
- Added command-line arguments: `--debug` and `--preset`
- Debug renders save with `_debug` suffix

## Key Design Decisions

1. **Per-Section Material Assignment**: Materials are applied to each section BEFORE the Join node, not after. This allows each section to have a distinct material.

2. **Switch-Based Toggle**: A single `Debug_Mode` boolean controls Switch nodes that select between production and debug materials. When False, no performance overhead.

3. **Material Socket Inputs**: Debug materials are exposed as modifier inputs, allowing users to customize debug colors at runtime without modifying the node group.

4. **Preset System**: Four preset palettes provide immediate utility while allowing customization.

## Usage

```python
# In Blender Python console
from lib.inputs import create_all_debug_materials, get_preset
from lib.inputs.node_group_builder import create_input_node_group

# Create node group
tree = create_input_node_group("MyKnob")

# Create debug materials
debug_mats = create_all_debug_materials(preset="rainbow")

# On the modifier, enable debug mode and assign materials:
# mod["Debug_Mode"] = True
# mod["Debug_A_Top_Material"] = debug_mats["A_Top"]
# etc.
```

```bash
# Render with debug mode from command line
blender --python projects/inputs/render_knob.py -- --debug --preset heat_map
```

## Verification

All verification criteria met:
- [x] Debug mode shows each section in distinct colors
- [x] Single boolean toggle switches between debug and production materials
- [x] Debug colors customizable via 4 preset palettes
- [x] No performance impact when debug mode is off (Switch node bypasses debug path)
- [x] Works with all input types using the zone-based builder
