# Phase 18.0 Plan 02: Projector Profile Database Summary

**Completed:** 2026-02-25
**Duration:** ~10 minutes
**Status:** Complete

---

## One-Liner

Projector profile database with 12 models (Epson, BenQ, Optoma, Sony) and YAML configuration support for physical projection mapping.

---

## Frontmatter

```yaml
phase: 18.0
plan: 02
subsystem: projection
tags: [projector, hardware, yaml, database, throw-ratio]
```

---

## Dependency Graph

```yaml
requires:
  - 18.0-01 (ProjectorProfile dataclass)

provides:
  - 12+ pre-defined projector profiles
  - Profile query functions (get, list, filter)
  - YAML configuration loader
  - Short-throw and 4K profile filters

affects:
  - 18.0-03 (Calibration Workflow)
  - 18.0-04 (Target Presets)
```

---

## Tech Stack

```yaml
tech-stack:
  added:
    - PyYAML (YAML configuration parsing)

  patterns:
    - Profile database pattern (dictionary registry)
    - Query/filter pattern (by throw ratio, resolution)
    - YAML configuration pattern (external profile definitions)
```

---

## Files

```yaml
key-files:
  created:
    - lib/cinematic/projection/physical/projector/profile_database.py
    - configs/cinematic/projection/projector_profiles.yaml
    - tests/unit/projection/test_profile_database.py

  modified: []
```

---

## Deliverables

### 1. Profile Database (profile_database.py)

**12 Projector Profiles:**
- **Epson (4):** Home Cinema 2150, Home Cinema 3800, Pro Cinema 6050UB, LS12000
- **BenQ (3):** MW632ST, TH685, W2700
- **Optoma (3):** UHD38, GT1080HDR, EH412
- **Sony (2):** VPL-HW45ES, VPL-VW295ES

**Query Functions:**
- `get_profile(name)` - Get single profile by name
- `list_profiles(manufacturer=None)` - List all or filter by manufacturer
- `get_profiles_by_throw_ratio(min_ratio, max_ratio)` - Filter by throw ratio range
- `get_profiles_by_resolution(min_width, min_height)` - Filter by minimum resolution
- `get_short_throw_profiles(ratio_threshold=0.8)` - Get short-throw projectors
- `get_4k_profiles()` - Get 4K/UHD projectors
- `load_profile_from_yaml(yaml_path, profile_name)` - Load from YAML config

### 2. YAML Configuration (projector_profiles.yaml)

**Structure:**
- Header with corrected throw ratio formula documentation
- Default sensor dimensions (36mm x 20.25mm)
- 12 pre-defined profiles matching Python database
- Custom projector template section for user extensions

### 3. Unit Tests (test_profile_database.py)

**22 Tests covering:**
- Database has 10+ profiles
- Profile retrieval (success and error cases)
- Manufacturer filtering (case-insensitive)
- Throw ratio filtering (short-throw, range queries)
- Resolution filtering (4K, 1080p minimum)
- Focal length calculations (3 models tested)
- YAML loading (success and error cases)
- Lens shift access and Blender conversion

**All tests passing:** 22/22 ✓

---

## Decisions Made

1. **Profile naming convention:** `{Manufacturer}_{Model}` (e.g., "Epson_Home_Cinema_2150")
   - Rationale: Consistent, searchable, no spaces

2. **Throw ratio formula:** `focal_length = sensor_width * throw_ratio`
   - Rationale: Verified by Geometry Rick, corrects previous division by 2 error

3. **Default sensor dimensions:** 36mm x 20.25mm (full frame equivalent)
   - Rationale: Standard reference for projection calculations

4. **Short-throw threshold:** 0.8 throw ratio
   - Rationale: Industry standard for short-throw projectors

5. **4K resolution threshold:** min_width=3840
   - Rationale: UHD standard (3840x2160)

6. **YAML as configuration format:**
   - Rationale: Human-readable, easy to extend, matches project patterns

---

## Verification Results

### Manual Verification

- [x] Database has 12+ profiles (12 profiles)
- [x] All required manufacturers present (Epson, BenQ, Optoma, Sony)
- [x] Query functions work correctly
- [x] YAML file loads successfully
- [x] Focal length calculations match expected values

### Automated Tests

```
22/22 tests PASSED
- 7 database tests
- 4 throw ratio filter tests
- 2 resolution filter tests
- 3 focal length calculation tests
- 3 YAML loading tests
- 3 lens shift tests
```

---

## Deviations from Plan

None - plan executed exactly as written.

---

## Next Phase Readiness

**Ready for:** 18.0-03 (Calibration Workflow)

**Blockers:** None

**Suggested improvements:**
- Consider adding more manufacturer profiles (JVC, LG, ViewSonic) in future
- Could add auto-detection of projector from throw distance/image size
- Could add projection calculator utilities (distance → image size, etc.)

---

## Key Learnings

1. **Profile database pattern works well** - Dictionary registry with query functions provides flexible access
2. **YAML + Python dual format** - Users can extend via YAML without touching code
3. **Throw ratio is the critical spec** - All calculations depend on this value being correct
4. **Lens shift varies widely** - Some projectors have none, others have extensive shift ranges

---

## Statistics

- **Lines of code:** 506 (profile_database.py) + 288 (YAML) + 189 (tests) = 983 total
- **Test coverage:** 22 unit tests
- **Profiles:** 12 (4 Epson, 3 BenQ, 3 Optoma, 2 Sony)
- **Query functions:** 7
- **Execution time:** ~10 minutes
