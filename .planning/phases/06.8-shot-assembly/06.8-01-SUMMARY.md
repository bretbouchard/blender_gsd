---
phase: 06.8-shot-assembly
plan: 01
subsystem: cinematic
completed: 2026-02-19
duration: 5 minutes
tags: [template-system, inheritance, shot-assembly, types, preset-loader]
requires:
  - 06.7-support-systems (support types used in template configs)
provides:
  - ShotTemplateConfig dataclass with extends/abstract pattern
  - ShotAssemblyConfig dataclass for complete shot configuration
  - Template loader functions with inheritance resolution
  - Circular inheritance detection
affects:
  - Future shot assembly phase (template instantiation)
  - Shot builder module (will use these types)
tech-stack:
  added:
    - dataclasses for template/assembly configs
  patterns:
    - extends/override inheritance pattern
    - deep merge for dict fields
    - abstract template blocking
---

# Phase 06.8 Plan 01: Shot Template Types + Loader Functions Summary

## One-liner

Added ShotTemplateConfig with extends/abstract inheritance support and template loader functions with circular detection for REQ-CINE-TEMPLATE.

## Key Changes

### lib/cinematic/types.py (+180 lines)

**ShotTemplateConfig dataclass:**
- `extends: str` - Parent template name for inheritance
- `abstract: bool` - Cannot render directly if True
- All optional override fields: camera, plumb_bob, rig, lighting_rig, lights, backdrop, environment_preset, imperfections, animation, render, color, composition, subject_name
- Full `to_dict()` / `from_dict()` serialization

**ShotAssemblyConfig dataclass:**
- `template: str` - Template name to use as base
- `subject: str` - Subject object name or specification
- Override fields: camera, plumb_bob, lighting_rig, lights, backdrop, color, render, animation
- `output_path: str` - Output directory for renders
- `metadata: Dict[str, Any]` - Additional metadata

### lib/cinematic/preset_loader.py (+176 lines)

**Constants:**
- `SHOT_CONFIG_ROOT = Path("configs/cinematic/shots")`

**Functions:**
- `get_shot_template(name: str) -> Dict[str, Any]` - Load template from templates.yaml
- `resolve_template_inheritance(template_name, loaded_templates, _chain)` - Resolve extends chain with:
  - Circular inheritance detection
  - Deep merge for dict fields (parent + child)
  - Abstract template blocking (cannot use directly)
- `list_shot_templates(include_abstract: bool = False) -> List[str]` - List templates, optionally excluding abstract
- `get_shot_assembly(name: str) -> Dict[str, Any]` - Load assembly from assemblies.yaml
- `list_shot_assemblies() -> List[str]` - List all assemblies

## Decisions Made

| Decision | Rationale |
|----------|-----------|
| extends field as string | Simple template name reference, resolved at load time |
| abstract boolean field | Clean way to mark non-renderable base templates |
| Deep merge for dicts | Allows partial overrides (e.g., just change camera.focal_length) |
| _chain parameter internal | Prevents API pollution while enabling circular detection |

## Deviations from Plan

None - plan executed exactly as written.

## Verification Results

```
ShotTemplateConfig and ShotAssemblyConfig OK
All verifications passed
- ShotTemplateConfig with extends/abstract: OK
- ShotAssemblyConfig with template reference: OK
- get_shot_template(), list_shot_templates(): OK
- resolve_template_inheritance() available: OK
```

## Next Phase Readiness

Ready for:
- Shot template YAML configuration files
- Shot builder module that uses resolve_template_inheritance()
- Assembly configuration files

## Commits

1. `477ec8f` - feat(06.8-01): add ShotTemplateConfig and ShotAssemblyConfig dataclasses
2. `c7606b5` - feat(06.8-01): add shot template loader functions with inheritance resolution
