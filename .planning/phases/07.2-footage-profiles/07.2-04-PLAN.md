---
phase: 07.2-footage-profiles
plan: 04
type: execute
wave: 4
depends_on: ["07.2-01", "07.2-02", "07.2-03"]
files_modified:
  - configs/cinematic/tracking/camera_profiles.yaml
  - lib/cinematic/tracking/__init__.py
  - lib/__init__.py
autonomous: true

must_haves:
  truths:
    - "Package exports expose all new classes and functions"
    - "Camera profiles have rolling shutter read times"
    - "Version bumped to 0.3.3"
  artifacts:
    - path: "lib/cinematic/tracking/__init__.py"
      provides: "All tracking module exports"
      exports: ["FFprobeMetadataExtractor", "FootageMetadata", "RollingShutterDetector", "RollingShutterCompensator", "RollingShutterConfig", "STMapGenerator", "VanishingPointDetector", "VanishingPoint"]
    - path: "configs/cinematic/tracking/camera_profiles.yaml"
      provides: "Extended camera profiles with rolling shutter"
      contains: "rolling_shutter"
  key_links:
    - from: "tracking.__init__"
      to: "footage, rolling_shutter, distortion, vanishing_points"
      via: "import statements"
      pattern: "from.*import"
---

<objective>
Update camera_profiles.yaml with rolling shutter read times and update package exports. Bump version to 0.3.3.

Purpose: Complete the tracking module by exposing all new classes and adding rolling shutter data to camera profiles.
Output: Updated __init__.py with all exports, extended camera_profiles.yaml, version 0.3.3.
</objective>

<execution_context>
@/Users/bretbouchard/.claude/get-shit-done/workflows/execute-plan.md
@/Users/bretbouchard/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Reference files
@lib/cinematic/tracking/__init__.py
@configs/cinematic/tracking/camera_profiles.yaml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update camera_profiles.yaml with rolling shutter data</name>
  <files>configs/cinematic/tracking/camera_profiles.yaml</files>
  <action>
    Add rolling shutter read times to all existing profiles. The YAML file already has extended profiles with Brown-Conrady coefficients. Add rolling_shutter section to each:

    ```yaml
    # Example for each profile:
    iphone_15_pro_main:
      # ... existing fields ...
      # Add rolling shutter section:
      rolling_shutter:
        read_time: 0.007  # 7ms typical for iPhone
        method: row_rolling
    ```

    Read times to add:
    - iPhone 14/15 Pro series: 0.007 seconds (7ms)
    - iPhone 14/15 Pro Ultra Wide: 0.008 seconds (8ms)
    - iPhone 15 Pro Telephoto: 0.006 seconds (6ms)
    - RED KOMODO: 0.004 seconds (4ms)
    - RED V-Raptor: 0.003 seconds (3ms)
    - ARRI Alexa Mini LF: 0.003 seconds (3ms)
    - ARRI Alexa 35: 0.003 seconds (3ms)
    - Blackmagic URSA 12K: 0.004 seconds (4ms)
    - Blackmagic Pocket 6K: 0.005 seconds (5ms)
    - Blackmagic Pocket 4K: 0.006 seconds (6ms)
    - Sony A7S III/FX6/FX3: 0.008 seconds (8ms)
    - Canon EOS R5/R6: 0.007 seconds (7ms)
    - Canon C70: 0.005 seconds (5ms)
    - DJI Mavic 3 Pro: 0.010 seconds (10ms)
    - DJI Inspire 3: 0.008 seconds (8ms)
    - DJI Mini 4 Pro: 0.012 seconds (12ms)
    - GoPro Hero 12: 0.016 seconds (16ms - significant)
    - DJI Osmo Action: 0.014 seconds (14ms)
    - Generic profiles: 0.010 seconds (10ms default)

    Also add color_profile field where known:
    - iPhone: "Apple Log" or "Standard"
    - RED: "REDWideGamutRGB/Log3G10"
    - ARRI: "ARRI Wide Gamut 4/LogC4"
    - Blackmagic: "Blackmagic Wide Gamut/Gen 5 Film"
    - Sony: "S-Log3/S-Gamut3.Cine"
    - Canon: "Canon Log 3/Cinema Gamut"
    - DJI: "D-Log M"
    - GoPro: "Protune Flat"
  </action>
  <verify>grep -q "rolling_shutter:" configs/cinematic/tracking/camera_profiles.yaml && echo "rolling_shutter sections added"</verify>
  <done>All camera profiles have rolling_shutter section with read_time and method fields</done>
</task>

<task type="auto">
  <name>Task 2: Update tracking/__init__.py with all exports</name>
  <files>lib/cinematic/tracking/__init__.py</files>
  <action>
    Update __init__.py to export all new classes and functions:

    ```python
    """
    Motion Tracking System for Blender GSD Framework

    Provides camera tracking, feature detection, stabilization, and
    external format import/export capabilities.

    Modules:
        types: Core data types (Track, Solve, Session, etc.)
        footage: Video format import, metadata extraction, content analysis
        rolling_shutter: Rolling shutter detection and compensation
        distortion: ST-Map generation for compositing
        vanishing_points: Focal length estimation from vanishing points
        camera_solver: Blender libmv camera solving integration
        point_tracker: Feature detection and KLT optical flow
        calibration: Camera calibration and lens distortion models
    """

    # Core types
    from .types import (
        # Enums
        TrackStatus,
        SolveStatus,
        FeatureDetector,
        # Data classes
        TrackPoint,
        Track,
        SolveResult,
        Solve,
        FootageInfo,
        FootageMetadata,
        TrackingSession,
        TrackingConfig,
        CameraProfile,
        StabilizationResult,
        ImportFormat,
        RollingShutterConfig,
        SUPPORTED_IMPORT_FORMATS,
    )

    # Footage module
    from .footage import (
        FootageImporter,
        FFprobeMetadataExtractor,
        VideoMetadata,
        ImageSequenceInfo,
        SUPPORTED_VIDEO_FORMATS,
        FRAME_RATES,
        is_supported_format,
        get_format_info,
        analyze_content,
    )

    # Rolling shutter module
    from .rolling_shutter import (
        RollingShutterDetector,
        RollingShutterCompensator,
        DEVICE_READ_TIMES,
        detect_rolling_shutter,
        compensate_rolling_shutter,
    )

    # Distortion/ST-Map module
    from .distortion import (
        STMapGenerator,
        STMapConfig,
        generate_st_map,
        save_st_map_exr,
    )

    # Vanishing points module
    from .vanishing_points import (
        VanishingPoint,
        VanishingPointDetector,
        detect_vanishing_points,
        estimate_focal_length,
    )

    # Calibration module
    from .calibration import (
        DistortionCoefficients,
        LensDistortion,
        CameraProfileManager,
        get_profile_manager,
        get_camera_profile,
    )

    __all__ = [
        # Enums
        "TrackStatus",
        "SolveStatus",
        "FeatureDetector",
        # Core data classes
        "TrackPoint",
        "Track",
        "SolveResult",
        "Solve",
        "FootageInfo",
        "FootageMetadata",
        "TrackingSession",
        "TrackingConfig",
        "CameraProfile",
        "StabilizationResult",
        "ImportFormat",
        "RollingShutterConfig",
        "SUPPORTED_IMPORT_FORMATS",
        # Footage
        "FootageImporter",
        "FFprobeMetadataExtractor",
        "VideoMetadata",
        "ImageSequenceInfo",
        "SUPPORTED_VIDEO_FORMATS",
        "FRAME_RATES",
        "is_supported_format",
        "get_format_info",
        "analyze_content",
        # Rolling shutter
        "RollingShutterDetector",
        "RollingShutterCompensator",
        "DEVICE_READ_TIMES",
        "detect_rolling_shutter",
        "compensate_rolling_shutter",
        # Distortion/ST-Map
        "STMapGenerator",
        "STMapConfig",
        "generate_st_map",
        "save_st_map_exr",
        # Vanishing points
        "VanishingPoint",
        "VanishingPointDetector",
        "detect_vanishing_points",
        "estimate_focal_length",
        # Calibration
        "DistortionCoefficients",
        "LensDistortion",
        "CameraProfileManager",
        "get_profile_manager",
        "get_camera_profile",
    ]

    __version__ = "1.1.0"
    ```

    Note: The tracking module has its own version (__version__) separate from the main cinematic package.
  </action>
  <verify>grep -q "FFprobeMetadataExtractor" lib/cinematic/tracking/__init__.py && grep -q "RollingShutterDetector" lib/cinematic/tracking/__init__.py && grep -q "STMapGenerator" lib/cinematic/tracking/__init__.py && echo "All new exports present"</verify>
  <done>All new classes and functions exported from tracking/__init__.py</done>
</task>

<task type="auto">
  <name>Task 3: Update main lib/__init__.py version to 0.3.3</name>
  <files>lib/__init__.py</files>
  <action>
    Update the version in lib/__init__.py from 0.3.0 to 0.3.3:

    Find the __version__ variable and update:
    - FROM: __version__ = "0.3.0"
    - TO: __version__ = "0.3.3"

    Also ensure the tracking module is properly exported:
    ```python
    # In lib/__init__.py, ensure tracking submodule is accessible
    from .cinematic.tracking import (
        # ... key exports ...
    )
    ```

    If lib/__init__.py doesn't export tracking items, add a section:
    ```python
    # Motion Tracking System
    from .cinematic.tracking import (
        TrackingSession,
        FootageInfo,
        FootageMetadata,
        CameraProfile,
        FootageImporter,
        FFprobeMetadataExtractor,
        RollingShutterDetector,
        STMapGenerator,
        VanishingPointDetector,
    )
    ```
  </action>
  <verify>grep -q "__version__.*0.3.3" lib/__init__.py && echo "Version 0.3.3"</verify>
  <done>Version bumped to 0.3.3 in lib/__init__.py</done>
</task>

</tasks>

<verification>
- All camera profiles have rolling_shutter section
- tracking/__init__.py exports all new classes
- Version is 0.3.3 in lib/__init__.py
- No import errors when testing outside Blender
</verification>

<success_criteria>
- All 35 camera profiles (actual count from camera_profiles.yaml) have rolling shutter read times
- 50+ exports available from tracking module
- Version 0.3.3 reflects Phase 7.2 completion
- Module structure ready for Phase 7.3 (External Import/Export)
</success_criteria>

<output>
After completion, create `.planning/phases/07.2-footage-profiles/07.2-04-SUMMARY.md`
</output>
